generator client {
  provider        = "prisma-client"
  output          = "./generated"
  previewFeatures = ["partialIndexes"]
}

datasource db {
  provider = "postgresql"
  schemas  = ["auth", "public"]
}




/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model users {
  id                          String                 @id @db.Uuid
  profiles                    profiles?
  @@schema("auth")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model appointments {
  id               String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  clinic_id        String              @db.Uuid
  pet_id           String              @db.Uuid
  owner_id         String              @db.Uuid
  appointment_date DateTime            @db.Timestamptz(6)
  reason           String?
  status           appointment_status? @default(reserved)
  expires_at       DateTime?           @db.Timestamptz(6)
  created_at       DateTime?           @default(now()) @db.Timestamptz(6)
  clinics          clinics             @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles         profiles            @relation(fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  pets             pets                @relation(fields: [pet_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clinics {
  id              String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name            String
  address         String
  phone_number    String?
  rating          Decimal?          @default(0.0) @db.Decimal(2, 1)
  is_open_24_7    Boolean?          @default(false)
  latitude        Float?
  longitude       Float?
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  appointments    appointments[]
  medical_records medical_records[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model medical_records {
  id          String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  pet_id      String      @db.Uuid
  clinic_id   String?     @db.Uuid
  title       String
  type        record_type
  file_url    String
  vet_notes   String?
  record_date DateTime?   @default(dbgenerated("CURRENT_DATE")) @db.Date
  created_at  DateTime?   @default(now()) @db.Timestamptz(6)
  clinics     clinics?    @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  pets        pets        @relation(fields: [pet_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model pets {
  id              String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  owner_id        String            @db.Uuid
  name            String
  species         String
  breed           String?
  gender          String?
  birth_date      DateTime?         @db.Date
  weight          Decimal?          @db.Decimal(4, 2)
  chip_number     String?
  avatar_url      String?
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  appointments    appointments[]
  medical_records medical_records[]
  profiles        profiles          @relation(fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  vaccinations    vaccinations[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model profiles {
  id           String         @id @db.Uuid
  full_name    String?
  email        String?
  avatar_url   String?
  created_at   DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?      @default(now()) @db.Timestamptz(6)
  appointments appointments[]
  pets         pets[]
  users        users          @relation(fields: [id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

model vaccinations {
  id                String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  pet_id            String          @db.Uuid
  vaccine_name      String
  administered_date DateTime?       @db.Date
  next_due_date     DateTime?       @db.Date
  status            vaccine_status? @default(upcoming)
  notes             String?
  created_at        DateTime?       @default(now()) @db.Timestamptz(6)
  pets              pets            @relation(fields: [pet_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

enum aal_level {
  aal1
  aal2
  aal3

  @@schema("auth")
}

enum code_challenge_method {
  s256
  plain

  @@schema("auth")
}

enum factor_status {
  unverified
  verified

  @@schema("auth")
}

enum factor_type {
  totp
  webauthn
  phone

  @@schema("auth")
}

enum oauth_authorization_status {
  pending
  approved
  denied
  expired

  @@schema("auth")
}

enum oauth_client_type {
  public
  confidential

  @@schema("auth")
}

enum oauth_registration_type {
  dynamic
  manual

  @@schema("auth")
}

enum oauth_response_type {
  code

  @@schema("auth")
}

enum one_time_token_type {
  confirmation_token
  reauthentication_token
  recovery_token
  email_change_token_new
  email_change_token_current
  phone_change_token

  @@schema("auth")
}

enum appointment_status {
  reserved
  pending
  confirmed
  completed
  cancelled

  @@schema("public")
}

enum record_type {
  image
  pdf

  @@schema("public")
}

enum vaccine_status {
  completed
  upcoming
  overdue

  @@schema("public")
}
