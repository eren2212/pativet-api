generator client {
  provider        = "prisma-client"
  output          = "./generated"
  previewFeatures = ["partialIndexes"]
}

datasource db {
  provider = "postgresql"
  schemas  = ["public"]
}




/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model appointments {
  id               String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  clinic_id        String              @db.Uuid
  pet_id           String              @db.Uuid
  owner_id         String              @db.Uuid
  appointment_date DateTime            @db.Timestamptz(6)
  reason           String?
  status           appointment_status? @default(reserved)
  expires_at       DateTime?           @db.Timestamptz(6)
  created_at       DateTime?           @default(now()) @db.Timestamptz(6)
  clinics          clinics             @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles         profiles            @relation(fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  pets             pets                @relation(fields: [pet_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model clinics {
  id              String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name            String
  address         String
  phone_number    String?
  rating          Decimal?          @default(0.0) @db.Decimal(2, 1)
  is_open_24_7    Boolean?          @default(false)
  latitude        Float?
  longitude       Float?
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  appointments    appointments[]
  medical_records medical_records[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model medical_records {
  id          String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  pet_id      String      @db.Uuid
  clinic_id   String?     @db.Uuid
  title       String
  type        record_type
  file_url    String
  vet_notes   String?
  record_date DateTime?   @default(dbgenerated("CURRENT_DATE")) @db.Date
  created_at  DateTime?   @default(now()) @db.Timestamptz(6)
  clinics     clinics?    @relation(fields: [clinic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  pets        pets        @relation(fields: [pet_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model pets {
  id              String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  owner_id        String            @db.Uuid
  name            String
  species         String
  breed           String?
  gender          String?
  birth_date      DateTime?         @db.Date
  weight          Decimal?          @db.Decimal(4, 2)
  chip_number     String?
  avatar_url      String?
  deleted_at      DateTime? @db.Timestamptz(6)
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  appointments    appointments[]
  medical_records medical_records[]
  profiles        profiles          @relation(fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  vaccinations    vaccinations[]
  default_for     profiles[]        @relation("ProfileToDefaultPet")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model profiles {
  id           String         @id @db.Uuid
  full_name    String?
  email        String?
  avatar_url   String?
  default_pet_id String?      @db.Uuid
  created_at   DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?      @default(now()) @db.Timestamptz(6)
  appointments appointments[]
  pets         pets[]
  default_pet    pets?        @relation("ProfileToDefaultPet", fields: [default_pet_id], references: [id], onDelete: SetNull)
  @@schema("public")
}

model vaccinations {
  id                String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  pet_id            String          @db.Uuid
  vaccine_name      String
  administered_date DateTime?       @db.Date
  next_due_date     DateTime?       @db.Date
  status            vaccine_status? @default(upcoming)
  notes             String?
  created_at        DateTime?       @default(now()) @db.Timestamptz(6)
  pets              pets            @relation(fields: [pet_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@schema("public")
}

enum appointment_status {
  reserved
  pending
  confirmed
  completed
  cancelled

  @@schema("public")
}

enum record_type {
  image
  pdf

  @@schema("public")
}

enum vaccine_status {
  completed
  upcoming
  overdue

  @@schema("public")
}
